<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buchungsplan</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <!-- Mit font-awsome kann man sehr einfach items einfügen-->
    <link rel="stylesheet" href="../css/CalendarStyle.css">



    <!-- -->

    <link rel="manifest" href="../site.webmanifest">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/main.css" type="text/css">

    <meta name="theme-color" content="#fafafa">

    <!--/ -->
</head>

<body>
    <!-- -->
    <div class="grid-layout">

        <div class="logobox">
            <img id="logo" src="../logo.png" alt="">
        </div>

        <div class="btn-group" role="group" id="linkleiste">
            <button class="list-group-item btn" type="button" id="210btn">210</button>
            <button class="list-group-item btn" type="button" id="206btn">206</button>
            <button class="list-group-item btn" type="button" id="205btn">205</button>
        </div>


        <!-- Eine Navigationsleiste (links) mit Links zu den Etagen -->
        <ul class="list-group" id="etageBtn201">
            <li class="list-group-item btn" id="eg-201">EG</li>
            <li class="list-group-item btn" id="og-201">1.OG</li>
            <li class="list-group-item btn" id="og2-201">2.OG</li>
        </ul>
        <!--/ -->


        <main class="calendararea">
            <div class="header">
                <div class="weekControls">
                    <i id="prevWeekBtn" class="fas fa-angle-double-left"></i> <!-- icon (doppelte links Pfeile)-->
                    <span class="weekDisplay"> <!-- zwischen den doppelten Pfeilen-->
                        <span id="weekStartDisplay"></span> <!--erster Tag der Woche-->
                        — <!-- Gedankenstrich zwischen erster und letzter Wochentag-->
                        <span id="weekEndDisplay"></span>
                    </span>
                    <i id="nextWeekBtn" class="fas fa-angle-double-right"></i>
                </div>
                <h1><u>Buchungsplan</u></h1>
                <div class="generalControls"> <!-- allgemeine kontrollelemente (neues event oder alle events löschen)-->
                    <i id="addButton" class="fas fa-plus"></i> <!-- plus Button-->
                </div>
            </div>

            <section id="calendar">
                <div class="dayTime"></div> <!-- Spalte mit den Uhrzeiten-->
                <div data-name="Montag" data-dayIndex="0" class="day"></div>
                <div data-name="Dienstag" data-dayIndex="1" class="day"></div>
                <div data-name="Mittwoch" data-dayIndex="2" class="day"></div>
                <div data-name="Donnerstag" data-dayIndex="3" class="day"></div>
                <div data-name="Freitag" data-dayIndex="4" class="day"></div>
                <div data-name="Samstag" data-dayIndex="5" class="day"></div>
            </section>

            <form id="bookModal">

                <h2 id="modalTitle">Raumbuchung</h2>

                <h4>201-015</h4>

                <label for="name" class="descriptor">Vor- und Nachname:</label>
                <div>
                    <input type="name" required id="bookName" name="name" class="shortInput">
                </div>

                <label for="email" class="descriptor">E-Mail:</label>
                <div>
                    <input type="email" required id="bookEmail" name="email" class="shortInput">
                </div>

                <label for="matrikel" class="descriptor">Matrikel-Nr.:</label>
                <div>
                    <input type="text" required id="bookMatrikel" name="matrikel" pattern="[0-9]{5}" placeholder="12345"
                        class="shortInput">
                </div>

                <label for="date" class="descriptor">Datum</label>
                <div>
                    <input type="date" required id="bookDate" name="date" class="shortInput">
                </div>

                <label for="time" class="descriptor">Zeit</label>
                <div>
                    <input type="time" required id="bookStart" name="time" class="shortInput">
                    —
                    <input type="time" required id="bookEnd" name="time" class="shortInput">
                </div>

                <label for="description" class="descriptor">Anmerkung:</label>
                <div>
                    <textarea name="description" id="bookDescription" maxlength="500"></textarea>
                </div>

                <div id="bookControls">
                    <input type="button" id="cancelButton" value="abbrechen" class="button">
                    <input type="submit" id="submitButton" value="buchen" class="button">
                </div>

                <div id="errors"></div>
            </form>


            <form id="cancelModal">

                <h2 id="cancelModalTitle">Buchungsverwaltung</h2>

                <label for="eventinfo" class="descriptor">Termin:</label>
                <div>
                    <textarea name="eventinfo" id="cancelEventinfo"></textarea>
                </div>

                <label for="matrikel" class="descriptor">Matrikel-Nr.:</label>
                <div>
                    <input type="text" required id="bookMatrikel" name="matrikel" pattern="[0-9]{5}" placeholder="12345"
                        class="shortInput">
                </div>

                <label for="verifizierung" class="descriptor">Verifizierungscode</label>
                <div>
                    <input type="password" required id="bookVerifizierung" name="verifizierung"
                        placeholder="siehe Bestätigungsmail" class="shortInput">
                </div>

                <div>
                    <input type="button" id="cancelButtonStorno" value="abbrechen" class="button">
                    <input type="submit" id="stornoButton" value="stornieren" class="button">
                </div>



            </form>

        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="../js/CalendarMain.js" type="module"></script> <!-- Um import und export benutzen zu können-->


    <!-- -->
    <script src="../js/vendor/modernizr-3.11.2.min.js"></script>
    <script src="../js/plugins.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/Geb_210_replacing_img.js"></script>
    <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->



    <script>

        /* DB verbindung
        $(document).ready(function () {
            getloadAndDisplayAllbookings();
        });*/
        /*
                function getloadAndDisplayAllbookings() {
                    console.log('loading all recs from api');
        
                    $.ajax({
                        url: 'http://localhost:8000/api/buchung/alle',
                        method: 'get',
                        contentType: 'application/json; charset=utf-8',
                        cache: false,
                        dataType: 'json'
                    }).done(function (response) {
                        console.log(response);
                        renderPictures(response);                
                    }).fail(function (jqXHR, statusText, error) {
                        console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
                        $('#errors').html('Ein Fehler ist aufgetreten');
                        $('#pics').text('Keine Buchungen vorhanden');
                    });
                }
        
        
        
                function getInfos(arr) { 
        
                  
                    if (arr.length == 0) {
                        node.text('Keine Bilder vorhanden');
                        return;
                    }
        
                    const matrikel_Nr = document.getElementById("bookMatrikel");
                    const datum = document.getElementById("bookDate");
                    const startzeit = document.getElementById("bookStart");
                    const endzeit = document.getElementById("bookEnd");
        
        
                }
        
                /*-------------------
        
                function postData() {
                    console.log('loading all recs from api');
        
                    $.ajax({
                        url: 'http://localhost:8000/api/buchung/alle',
                        method: 'get',
                        contentType: 'application/json; charset=utf-8',
                        cache: false,
                        dataType: 'json'
                    }).done(function (response) {
                        console.log(response);
                        getInfos(response);
        
        
                    }).fail(function (jqXHR, statusText, error) {
                        console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
                        //$('#output').html('Ein Fehler ist aufgetreten');
                        //$('#pics').text('Keine Bilder vorhanden');
                    });
                }
        
                */

        //-------------------------------------------------------------------

        $('#bookModal').submit(function (event) {
            console.log("form submit called");

            // disable default event
            event.preventDefault();

            // only do something if some files selected
            if ($('#bookMatrikel').length == 0) {
                alert('Sie haben keine MAtrikelnummer eingegeben');
                return;
            }

            // convert data of form to object
            var formData = new FormData(this);


            // send form with ajax
            $.ajax({
                url: 'http://localhost:8000/api/buchung/aufladen',
                type: 'POST',
                data: formData,
                contentType: false,
                cache: false,
                processData: false,
                dataType: 'json'
            })
                .done(function (response) {
                    console.log('response received, uploaded files cnt=' + response.length);
                    console.log($('#output').text(response.length + ' Datei(en) aufgeladen'));

                })
                .fail(function (xhr) {
                    console.log('error received');
                    alert('Es ist ein Fehler beim Aufladen aufgetreten');
                });
        });




    </script>


    <script>
        window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
        ga('create', 'UA-XXXXX-Y', 'auto'); ga('set', 'anonymizeIp', true); ga('set', 'transport', 'beacon'); ga('send', 'pageview')
    </script>
    <!--/ -->
</body>

</html>