<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Buchungsplan</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
<!-- Mit font-awsome kann man sehr einfach items einfügen-->
<link rel="stylesheet" href="../css/CalendarStyle.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>



<!-- -->

<link rel="manifest" href="../site.webmanifest">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<link rel="stylesheet" href="../css/normalize.css">
<link rel="stylesheet" href="../css/main.css" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<meta name="theme-color" content="#fafafa">


<body>
  <div class="grid-layout">
    <div class="logobox">
      <img class="logo" src="../logo.png" alt="">
    </div>

    <div class="btn-group linkleiste" role="group">
      <button class="btn" type="button" id="lageplanBtn">Lageplan</button>
      <button class="btn" type="button" id="kontaktBtn">Kontakt</button>
      <button class="btn" type="button" id="buchungenBtn">Meine Buchungen</button>
      <button class="btn" type="button" id="anfahrtBtn">Anfahrt</button>
    </div>
  </div>


  <main class="calendararea">
    <div class="calendarheader">
      <div class="weekControls">
        <i id="prevWeekBtn" class="fas fa-angle-double-left"></i> <!-- icon (doppelte links Pfeile)-->
        <span class="weekDisplay"> <!-- zwischen den doppelten Pfeilen-->
          <span id="weekStartDisplay"></span> <!--erster Tag der Woche-->
          — <!-- Gedankenstrich zwischen erster und letzter Wochentag-->
          <span id="weekEndDisplay"></span>
        </span>
        <i id="nextWeekBtn" class="fas fa-angle-double-right"></i>
      </div>
      <h1><u>Buchungsplan</u></h1>
      <div class="generalControls"> <!-- allgemeine kontrollelemente (neues event oder alle events löschen)-->
        <i id="addButton" class="fas fa-plus"></i> <!-- plus Button-->
      </div>
    </div>

    <section id="calendar">
      <div class="dayTime"></div> <!-- Spalte mit den Uhrzeiten-->
      <div data-name="Montag" data-dayIndex="0" class="day"></div>
      <div data-name="Dienstag" data-dayIndex="1" class="day"></div>
      <div data-name="Mittwoch" data-dayIndex="2" class="day"></div>
      <div data-name="Donnerstag" data-dayIndex="3" class="day"></div>
      <div data-name="Freitag" data-dayIndex="4" class="day"></div>
      <div data-name="Samstag" data-dayIndex="5" class="day"></div>
    </section>

    <form id="bookModal">

      <h2 id="modalTitle">Raumbuchung</h2>

      <h4>201-015</h4>

      <label for="name" class="descriptor">Vor- und Nachname:</label>
      <div>
        <input type="name" required id="bookName" name="name" class="shortInput">
      </div>

      <label for="email" class="descriptor">E-Mail:</label>
      <div>
        <input type="email" required id="bookEmail" name="email" class="shortInput">
      </div>

      <label for="matrikel" class="descriptor">Matrikel-Nr.:</label>
      <div>
        <input type="text" required id="bookMatrikel" name="matrikel" pattern="[0-9]{5}" placeholder="12345"
          class="shortInput">
      </div>

      <label for="date" class="descriptor">Datum</label>
      <div>
        <input type="date" required id="bookDate" name="date" class="shortInput">
      </div>

      <label for="time" class="descriptor">Zeit</label>
      <div>
        <input type="time" required id="bookStart" name="time" class="shortInput">
        —
        <input type="time" required id="bookEnd" name="time" class="shortInput">
      </div>

      <label for="description" class="descriptor">Anmerkung:</label>
      <div>
        <textarea name="description" id="bookDescription" maxlength="500"></textarea>
      </div>

      <div id="bookControls">
        <input type="button" id="cancelButton" value="abbrechen" class="button">
        <input type="submit" id="submitButton" value="buchen" class="button">
      </div>

      <div id="errors"></div>
    </form>


    <form id="cancelModal">

      <h2 id="cancelModalTitle">Buchungsverwaltung</h2>

      <label for="eventinfo" class="descriptor">Termin:</label>
      <div>
        <textarea name="eventinfo" id="cancelEventinfo"></textarea>
      </div>

      <label for="matrikel" class="descriptor">Matrikel-Nr.:</label>
      <div>
        <input type="text" required id="bookMatrikel" name="matrikel" pattern="[0-9]{5}" placeholder="12345"
          class="shortInput">
      </div>

      <label for="verifizierung" class="descriptor">Verifizierungscode</label>
      <div>
        <input type="password" required id="bookVerifizierung" name="verifizierung" placeholder="siehe Bestätigungsmail"
          class="shortInput">
      </div>

      <div>
        <input type="button" id="cancelButtonStorno" value="abbrechen" class="button">
        <input type="submit" id="stornoButton" value="stornieren" class="button">
      </div>
    </form>

  </main>

  <footer class="footer">
    <div class="footer-container">
      <div id="footerFirma">
        <h4>RESERVE IT</h4>
        <p>Musterstr. 33, <br> 72458 Albstadt-Ebingen</p>
      </div>

      <div id="footerAboutUs">
        <a href="ueberuns.html">Über Uns</a> <br>
        <a href="kontakt.html">Kontakt</a><br>
        <a href="https://maps.app.goo.gl/uSkcTxGHvDX1AJY8A" target="_blank">Anfahrt</a>
      </div>

      <div id="footerImpressum">
        <a href="Impressum.html">Imperessum</a><br>
        <a href="Datenschutz.html">Datenschutz</a><br>
        <a href="AGB.html">AGB</a>
      </div>

      <div id="footerSocialmedia">
        <a href="https://de-de.facebook.com/" class="fa fa-facebook"></a>
        <a href="https://de.linkedin.com/" class="fa fa-linkedin"></a>
        <a href="https://twitter.com/" class="fa fa-twitter"></a>
      </div>
    </div>
  </footer>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="../js/CalendarMain.js" type="module"></script> <!-- Um import und export benutzen zu können-->
  <script src="../js/main.js"></script>


  <script src="../js/connections.js"></script>

  <script>
/*
    function generateRandomString() {
      var length = 8;
      var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      var result = '';
      for (var i = 0; i < length; i++) {
        result += characters.charAt(Math.floor(Math.random() * characters.length));
      }
      return result;
    }

    console.log(generateRandomString());


    $('#bookModal').submit(function (event) {
      console.log("form submit called");

      // disable default event
      event.preventDefault();
      var datum = $('#bookDate').val();
      var start = $('#bookStart').val();
      var end = $('#bookEnd').val();
      var matNr = $('#bookMatrikel').val();
      var buchungCode = generateRandomString();

      var startDate = datum + " " + start + ":00"
      var endDate = datum + " " + end + ":00"
      //var matNr = event.matNr;
      console.log(startDate + "\n" + endDate);

      //alert(datum);



      // convert data of form to object
      var meinObjekt = {
        RaumID: 1,
        BenutzerID: matNr,
        Startzeit: startDate,
        Endzeit: endDate,
        BuchungCode: buchungCode
      };

      // Erstellen Sie ein neues FormData-Objekt
      var formData = new FormData();

      // Fügen Sie jedes Element aus dem JSON-Objekt zum FormData-Objekt hinzu
      for (var schluessel in meinObjekt) {
        formData.append(schluessel, meinObjekt[schluessel]);
      }

      console.log(formData);

      // send form with ajax
      $.ajax({
        url: 'http://localhost:8000/api/buchung/erstellen',
        type: 'POST',
        data: formData,
        contentType: false,
        cache: false,
        processData: false,
        dataType: 'json'
      }).done(function (response) {
        console.log('response received, uploaded files cnt=' + response.length);
        console.log($('#output').text(response.length + ' Datei(en) aufgeladen'));

      }).fail(function (xhr) {
        console.log('error received');
        alert('Es ist ein Fehler beim Aufladen aufgetreten');
      });

    });


  
  */
  </script>

</body>

</html>